"use strict";(self.webpackChunkballistica_web=self.webpackChunkballistica_web||[]).push([[980],{2980:(F,c,s)=>{s.r(c),s.d(c,{LoginComponent:()=>h,LoginModule:()=>C});var a=s(177),g=s(8498),t=s(4438),l=s(1626);const p="https://mods.ballistica.workers.dev";new l.Lr({"Content-Type":"application/json"});let d=(()=>{class o{constructor(n){this.http=n}getProxy(){return this.http.post(`${p}/getproxy`,{})}checkLoginProgress(n,e,i){return this.http.get(`${p}/login`,{params:{date:n,proxy:e,key:i},observe:"response"})}static#t=this.\u0275fac=function(e){return new(e||o)(t.KVO(l.Qq))};static#n=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var u=s(6829);function f(o,r){1&o&&(t.j41(0,"h2"),t.EFF(1,"LOGIN VIA V2"),t.k0s())}function m(o,r){1&o&&(t.j41(0,"h2"),t.EFF(1,"LOGGED IN AS"),t.k0s())}function v(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",9),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.login())}),t.EFF(1," Login with Ballistica V2 Account "),t.k0s()}}function _(o,r){if(1&o&&(t.j41(0,"div"),t.EFF(1," Complete your authentication.... "),t.nrm(2,"br"),t.EFF(3," auto redirecting to "),t.nrm(4,"br"),t.j41(5,"a",10),t.EFF(6),t.k0s()()),2&o){const n=t.XpG(2);t.R7$(5),t.FS9("href",n.url,t.B4B),t.R7$(),t.JRh(n.url)}}function k(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",11),t.EFF(1),t.nrm(2,"br")(3,"br"),t.j41(4,"div",9),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.retry())}),t.EFF(5,"retry"),t.k0s()()}if(2&o){const n=t.XpG(2);t.R7$(),t.SpI(" ",n.error," ")}}function y(o,r){if(1&o&&(t.j41(0,"div"),t.DNE(1,v,2,0,"div",7)(2,_,7,2,"div",3)(3,k,6,1,"div",8),t.k0s()),2&o){const n=t.XpG();t.R7$(),t.Y8G("ngIf",!n.url),t.R7$(),t.Y8G("ngIf",n.url&&!n.error),t.R7$(),t.Y8G("ngIf",n.error)}}function I(o,r){if(1&o&&(t.j41(0,"div",12),t.nrm(1,"br")(2,"br")(3,"img",13),t.EFF(4),t.k0s()),2&o){const n=t.XpG();t.R7$(4),t.SpI(" ",n.tag," ")}}function b(o,r){1&o&&(t.j41(0,"div",14)(1,"p"),t.EFF(2," This site works with BombSquad 'V2' accounts (also called Ballistica accounts). These accounts are beginning to replace legacy accounts starting in BombSquad 1.7. "),t.nrm(3,"br"),t.EFF(4," Above login button will redirect you to Ballistica website where you can enter you email and password. "),t.nrm(5,"br"),t.EFF(6,' To use other login types like Google Play, you can click on "Manager Account" button within your game account options. It will login you V2 account in browser and then you can continue with above login process. '),t.k0s()())}let h=(()=>{class o{constructor(n,e,i){this.authService=n,this.tokenStorage=e,this.router=i,this.proxy="",this.key="",this.isLoggedIn=!1}ngOnInit(){this.tokenStorage.getToken()&&(this.tag=this.tokenStorage.getUser().tag,this.isLoggedIn=!0,this.router.navigate(["/mods"]))}login(){this.authService.getProxy().subscribe(n=>{this.date=JSON.stringify(n.end_command[1].s),this.proxy=n.end_command[1].p,this.key=n.end_command[1].k,this.url=n.open_url,setTimeout(()=>{this.child=window.open(this.url,"_blank")},2e3),this.checkProgress()})}checkProgress(){this.authService.checkLoginProgress(this.date,this.proxy,this.key).subscribe(n=>{if(202==n.status)setTimeout(()=>{this.checkProgress()},3e3);else if(200==n.status){const e=JSON.parse(atob(n.body.token.split(".")[1]));this.tokenStorage.saveUser(e),this.tokenStorage.saveToken(n.body.token),this.child?.close(),this.afterLoggedIn()}},n=>{this.error=n.error})}afterLoggedIn(){const n=this.tokenStorage.getUser();this.tag=n.tag,this.isLoggedIn=!0,setInterval(()=>{location.reload()},1e3)}retry(){location.reload()}static#t=this.\u0275fac=function(e){return new(e||o)(t.rXU(d),t.rXU(u.I),t.rXU(g.Ix))};static#n=this.\u0275cmp=t.VBU({type:o,selectors:[["app-login"]],decls:9,vars:5,consts:[[1,"login-page"],[1,"login-options"],[1,"heading"],[4,"ngIf"],[1,"login-process"],["class","tag",4,"ngIf"],["class","info",4,"ngIf"],["class","login-btn",3,"click",4,"ngIf"],["class","error",4,"ngIf"],[1,"login-btn",3,"click"],[3,"href"],[1,"error"],[1,"tag"],["src","assets/img/icon_account_v2.svg","alt",""],[1,"info"]],template:function(e,i){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.DNE(3,f,2,0,"h2",3)(4,m,2,0,"h2",3),t.k0s(),t.j41(5,"div",4),t.DNE(6,y,4,3,"div",3)(7,I,5,1,"div",5),t.k0s(),t.DNE(8,b,7,0,"div",6),t.k0s()()),2&e&&(t.R7$(3),t.Y8G("ngIf",!i.isLoggedIn),t.R7$(),t.Y8G("ngIf",i.isLoggedIn),t.R7$(2),t.Y8G("ngIf",!i.isLoggedIn),t.R7$(),t.Y8G("ngIf",i.isLoggedIn),t.R7$(),t.Y8G("ngIf",!i.url))},dependencies:[a.bT],styles:[".login-page[_ngcontent-%COMP%]{background-color:#000;color:#fff;padding:80px 0;min-height:65vh}.login-options[_ngcontent-%COMP%]{width:80%;margin:auto;white-space:pre-wrap}.login-options[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{text-align:center}.login-process[_ngcontent-%COMP%]{padding-top:40px;display:flex;justify-content:center}.login-btn[_ngcontent-%COMP%]{border:1px solid white;width:auto;padding-top:3.5px;cursor:pointer;height:30px;text-align:center}.tag[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px}.info[_ngcontent-%COMP%]{padding-top:20px;color:#ffffff7a}"]})}return o})();const L=[{path:"",component:h}];let C=(()=>{class o{static#t=this.\u0275fac=function(e){return new(e||o)};static#n=this.\u0275mod=t.$C({type:o});static#o=this.\u0275inj=t.G2t({imports:[a.MD,g.iI.forChild(L)]})}return o})()}}]);